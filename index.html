<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Study Timer</title>

<style>
body{
    font-family: Arial, sans-serif;
    background:#f2f4f7;
    margin:0;
    text-align:center;
}
.page{display:none;padding:30px}
.active{display:block}
.box{
    background:#fff;
    margin:20px auto;
    max-width:360px;
    padding:20px;
    border-radius:12px;
    box-shadow:0 4px 10px rgba(0,0,0,.15)
}
.time{font-size:72px;margin:30px 0}
.message{
    font-size:24px;
    color:#d32f2f;
    display:none;
    margin:20px 0
}
button{
    font-size:18px;
    padding:12px 26px;
    margin:8px
}
</style>
</head>

<body>

<div id="home" class="page active">
    <h1>â³ Chá»n cháº¿ Ä‘á»™ há»c</h1>

    <div class="box">
        <h3>ğŸ“˜ Há»c hiá»ƒu sÆ¡ (30 phÃºt)</h3>
        <button onclick="buttonSound(); goTimer(2,'basic')">Báº¯t Ä‘áº§u</button>
    </div>

    <div class="box">
        <h3>ğŸ“— Há»c hiá»ƒu sÃ¢u (90 phÃºt)</h3>
        <button onclick="buttonSound(); goTimer(2,'deep')">Báº¯t Ä‘áº§u</button>
    </div>

    <div class="box">
        <h3>ğŸ”¥ Tryhard (180 phÃºt)</h3>
        <button onclick="buttonSound(); goTimer(2,'tryhard')">Báº¯t Ä‘áº§u</button>
    </div>
</div>

<div id="timerPage" class="page">
    <div id="display" class="time">00:00</div>

    <div id="success" class="message"></div>

    <button onclick="buttonSound(); startTimer()">â–¶ Start</button>
    <button onclick="buttonSound(); resetTimer()">âŸ³ Reset</button>
    <br>
    <button onclick="buttonSound(); goHome()">â¬… Quay láº¡i</button>
</div>

<script>
/* ===== Lá»œI CHÃšC THEO CHáº¾ Äá»˜ ===== */
const finishMessages = {
    basic: "ğŸ‰ Báº¡n Ä‘Ã£ hiá»ƒu bÃ i chá»‰ vá»›i 30 phÃºt sao?",
    deep: "ğŸ’¡ ChÃºc má»«ng, báº¡n khÃ¡ chÄƒm chá»‰ nhá»‰?",
    tryhard: "ğŸ”¥ KhÃ´ng Ä‘á»— BÃ¡ch khoa thÃ¬ hÆ¡i phÃ­!!!"
};

let currentMode = "";

/* ===== TIMER ===== */
let totalTime = 0;
let remaining = 0;
let timer = null;
let alarmInterval = null;

/* ===== Ã‚M THANH Báº¤M NÃšT ===== */
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

function buttonSound(){
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.type = "square";
    osc.frequency.value = 600;
    gain.gain.setValueAtTime(0.12, audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.07);
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    osc.start();
    osc.stop(audioCtx.currentTime + 0.07);
}

/* ===== Ã‚M THANH BÃO Äá»˜NG ===== */
function alarmBeep(){
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.type = "square";
    osc.frequency.value = 900;
    gain.gain.value = 0.5;
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    osc.start();
    osc.stop(audioCtx.currentTime + 0.15);
}

function startAlarm(){
    stopAlarm();
alarmInterval = setInterval(alarmBeep, 900);
}

function stopAlarm(){
    if(alarmInterval){
        clearInterval(alarmInterval);
        alarmInterval = null;
    }
}

/* ===== CHUYá»‚N TRANG ===== */
function goTimer(sec, mode){
    totalTime = sec;
    remaining = sec;
    currentMode = mode;

    update();
    document.getElementById("success").style.display = "none";
    document.getElementById("home").classList.remove("active");
    document.getElementById("timerPage").classList.add("active");
}

function startTimer(){
    if(timer) return;

    timer = setInterval(()=>{
        remaining--;
        update();

        if(remaining <= 0){
            clearInterval(timer);
            timer = null;
            remaining = 0;
            update();

            const success = document.getElementById("success");
            success.innerText = finishMessages[currentMode] || "â° Háº¿t giá»";
            success.style.display = "block";

            startAlarm();
        }
    },1000);
}

function resetTimer(){
    clearInterval(timer);
    timer = null;
    remaining = totalTime;
    update();
    document.getElementById("success").style.display = "none";
    stopAlarm();
}

function goHome(){
    clearInterval(timer);
    timer = null;
    stopAlarm();
    document.getElementById("timerPage").classList.remove("active");
    document.getElementById("home").classList.add("active");
}

/* ===== HIá»‚N THá»Š ===== */
function update(){
    const m = Math.floor(remaining / 60);
    const s = remaining % 60;
    document.getElementById("display").innerText =
        String(m).padStart(2,"0") + ":" + String(s).padStart(2,"0");
}
</script>

</body>
</html>